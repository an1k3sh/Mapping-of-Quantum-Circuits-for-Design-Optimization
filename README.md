# Mapping-of-Quantum-Circuits-for-Design-Optimization

This repository contains the work done as a part of the SPARK 2023 : Summer Internship Program at IIT Roorkee.

## Requirements

The following dependencies are required to use these converters:
- Python 3.x
- Qiskit

## Files

The repository contains the following `python` files:

1. `revlibparser.py`: This file provides a parser for the .real benchmark format. It defines functions to read and parse the benchmark file, and convert it into a Qiskit `QuantumCircuit` object. The `read_circuit` function takes a file path as input and returns a `QuantumCircuit` representing the benchmark.
2. `QASM_converter.py`: This script utilizes the `revlibparser.py` module to convert benchmarks in the `.real` format into QASM code. It locates the benchmark files in a directory named "reals" and generates corresponding QASM files in a directory named `qasm_files`. The QASM files can be used with other tools or simulators that support the QASM format.
3. `Implementation.py` - This file contains the implementation of the heuristic suggested in Bhattacharjee et al., "A Novel Approach for Nearest Neighbor Realization of 2D Quantum Circuits", IEEE ISVLSI, 2018. The code uses the benchmarks present in the `real` directory as the inputs. The order of the resulting swaps and the circuit arrangements obtained after each swap are stored as text files corresponding to the name of the benchmark in the `result` directory. A report on the swap and gate counts for various benchmarks is present in the file `swaps.csv`
4. `Proposed_Heuristic_Implementation.py` - This file contains the implementation of a generalization of the methodology suggested in Bhattacharjee et al. for non-ideal 2D lattices. For representation purposes, lattices of certain quantum computers have been assumed to obtain elementary results:
   - IBM Quito for upto 5 qubits
   - IBM Nairobi for upto 7 qubits
   - IBM Guadeloupe for upto 16 qubits
   - IBM Cairo for upto 27 qubits
   - IBM Sherbrooke for upto 127 qubits
   - For circuits with more than 127 qubits, an ideal lattice has been assumed.
The code uses the benchmarks present in the `real` directory as the inputs. The order of the resulting swaps and the circuit arrangements obtained after each swap are stored as text files corresponding to the name of the benchmark in the `result_imp` directory. A report on the swap and gate counts for various benchmarks is present in the file `swaps_imp.csv`

The repository contains the following `ipynb` files (Jupyter Notebooks):

1. `Implementation_2018_ISVLSI_Bhattacharjee.ipynb` - This .ipynb file is an interactive implementation of the heuristic suggested in Bhattacharjee et al., "A Novel Approach for Nearest Neighbor Realization of 2D Quantum Circuits", IEEE ISVLSI, 2018. The .real benchmark file read in the notebook can be changed to get an interactive and better visualization of the results
2. `Implementation_2018_ISVLSI_Bhattacharjee.ipynb` - This .ipynb file is an interactive implementation of a generalization of the methodology suggested in Bhattacharjee et al. for non-ideal 2D lattices. The .real benchmark file read in the notebook can be changed to get an interactive and better visualization of the results.

The repository contains the following `csv` files:

1. `swap.csv` - This file contains the report on the swap and gate counts for various benchmarks, as generated by running the `Implementation.py` file
2. `swaps_imp.csv` - This file contains the report on the swap and gate counts for various benchmarks, as generated by running the `Proposed_Heuristic_Implementation.py` file

The repository contains the following folders:

1. `real` - This folder contains the benchmarks which have been used to evaluate implementations. These benchmarks are available at the [Revlib Website]( https://www.revlib.org ).
2. `qasm_files` - This folder contains the QASM files which have been generated by `QASM_converter.py` after parsing the benchmarks present in the `real` folder.
3. `result` - This folder contains the order of the resulting swaps and the circuit arrangements obtained after each swap for each benchmark, as generated by running the `Implementation.py` file.
4. `result_imp` - This folder contains the order of the resulting swaps and the circuit arrangements obtained after each swap for each benchmark, as generated by running the `Proposed_Heuristic_Implementation.py` file.

## Usage

Run the files `Implementation.py`, `Proposed_Heuristic_Implementation.py`, `Implementation_2018_ISVLSI_Bhattacharjee.ipynb` or `Implementation_2018_ISVLSI_Bhattacharjee.ipynb`, to evaluate the .real files present in the `real` folder and obtaining the reports as described in the previous section

## Methodologies

### Implementation of Existing Work

**Problem Statement:** The heuristic technique transforms the input quantum circuits into nearest neighbour based design and limits the swap gate utilisation to contain the circuit overhead.

**Problem Approach:** The heuristic considers a 3 phase approach for the solution: Qubit Selection Policy, Qubit Placement Policy and SWAP Gate Insertion. The methodology for the implemenatation of Bhattacharjee et al. has been described in the paper.

### Implementation of Improvement

**Problem Statement:** The heuristic suggested by Bhattacharjee et al. (2018) considers a placement strategy for complete 2D lattices. This improvement focuses on expanding the approach to generalise it for non-ideal lattices.

**Problem Approach:** The heuristic considers the same approach for the solution, with improvements in qubit placement policy:

1. **Qubit Selection Policy:** 3 information tables are constructed for qubit selection: time interaction table, costing table and preference table.
  – Sum of the interaction times for each qubit is considered in the time interaction table.
  – Costing table contains the sum total of the costing times for each qubit.
  – Qubit preference table contains the preference index of each qubit, i.e. the ratio of total costing time to
total interaction time for each qubit.
  – The qubits are then sorted in decreasing order of their preference index.
2. **Qubit Placement Policy:** The qubits are to be placed into an existing 2D grid structure, which represent a present day architecture by marking positions which are not available as X.
```
Input: Qubit sorted preference table (PT) and 2D grid structure (GS)
Output: Qubit placement in 2D grid structure (GS)
  begin
    for ((qk ∈ PT) and (PT ≠ null)) do
      if (k == 1) then
        Place qk at a central node with highest number of neighbours
      else
        Find a vacant available location GS (row, column) adjacent to maximum number of empty cells
        if (Num_of(GS (row, column)) == 1) then
          Place qk at location GS (row, column)
        else
          Retrieve location GS (row, column) of last qubit qk-1
          Place qk at one of the locations GS (row ± a, column ±b) where a, b ∈ {1, 2}
        end if
      end if
    end for
    return GS
  end
```
3. **SWAP Gate Insertion:** SWAP gates are inserted to place the qubits that need to interact adjacent to each other.

## Results

The results obtain after evaluation are stored in the `result` and `result_imp` directories, and the `swap.csv` and `swaps_imp.csv` files.

## Conclusion

This work demonstrates a heuristic based placement strategy for the transformation of quantum circuits to an NN-compliant design which is suitable to be run on present day architectures.

## Future Work

- Exact techniques take longer time to compute the resulting circuit especially for larger circuits, while heuristic techniques have the issue of non-optimality of the resulting circuit. Techniques which combine both these approaches appropriately would be useful.
- ML and RL based methods may provide beneficial reductions and swap gate insertions in the circuit.

## References

1. R. Wille, A. Lye, and R. Drechsler, “Optimal swap gate insertion for nearest neighbor quantum circuits,” in 2014 19th Asia and South Pacific Design Automation Conference (ASP-DAC), pp. 489–494, 2014.
2. R. Wille, L. Burgholzer, and A. Zulehner, “Mapping quantum circuits to ibm qx architectures using the minimal number of swap and h operations,” in Proceedings of the 56th Annual Design Automation Conference 2019, DAC ’19, (New York, NY, USA), Association for Computing Machinery, 2019.
3. O. Keszocze, N. Mohammadzadeh, and R. Wille, “Exact physical design of quantum circuits for ion-trap-based quantum architectures,” in 2021 Design, Automation & Test in Europe Conference & Exhibition (DATE), pp. 344–349, 2021.
4. P. Niemann, R. Wille, and R. Drechsler, “Improved synthesis of clifford+t quan- tum functionality,” in 2018 Design, Automation & Test in Europe Conference & Exhibition (DATE), pp. 597–600, 2018.
5. S. Schneider, L. Burgholzer, and R. Wille, “A SAT encoding for optimal clifford cir- cuit synthesis,” in Proceedings of the 28th Asia and South Pacific Design Automation Conference, ACM, jan 2023.
6. R. Wille, O. Keszocze, M. Walter, P. Rohrs, A. Chattopadhyay, and R. Drechsler, “Look-ahead schemes for nearest neighbor optimization of 1d and 2d quantum circuits,” in 2016 21st Asia and South Pacific Design Automation Conference (ASP- DAC), pp. 292–297, 2016.
7. A. Matsuo, W. Hattori, and S. Yamashita, “Reducing the overhead of mapping quantum circuits to ibm q system,” in 2019 IEEE International Symposium on Circuits and Systems (ISCAS), pp. 1–5, 2019.
8. A. Bhattacharjee, C. Bandyopadhyay, R. Wille, R. Drechsler, and H. Rahaman, “Improved look-ahead approaches for nearest neighbor synthesis of 1d quantum circuits,” in 2019 32nd International Conference on VLSI Design and 2019 18th International Conference on Embedded Systems (VLSID), pp. 203–208, 2019.
9. A. Bhattacharjee, C. Bandyopadhyay, R. Wille, R. Drechsler, and H. Rahaman, “A novel approach for nearest neighbor realization of 2d quantum circuits,” in 2018 IEEE Computer Society Annual Symposium on VLSI (ISVLSI), pp. 305–310, 2018.
10. A. Bhattacharjee, C. Bandyopadhyay, A. Mukherjee, R. Wille, R. Drechsler, and H. Ra- haman, “Efficient implementation of nearest neighbor quantum circuits using clustering with genetic algorithm,” in 2020 IEEE 50th International Symposium on Multiple-Valued Logic (ISMVL), pp. 40–45, 2020.
11. K. Seino and S. Yamashita, “An smt-solver-based synthesis of nna-compliant quantum circuits consisting of cnot, h and t gates,” in 2023 28th Asia and South Pacific Design Automation Conference (ASP-DAC), pp. 196–201, 2023.
12. A. Zulehner, A. Paler and R. Wille, "An Efficient Methodology for Mapping Quantum Circuits to the IBM QX Architectures," in IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems, vol. 38, no. 7, pp. 1226-1236, July 2019, doi: 10.1109/TCAD.2018.2846658.
13. Ding, Jingwen & Yamashita, Shigeru. (2019). Exact Synthesis of Nearest Neighbor Compliant Quantum Circuits in 2-D Architecture and Its Application to Large-Scale Circuits. IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems. PP. 1-1. 10.1109/TCAD.2019.2907919.
